var f=(w,d,c)=>new Promise((r,m)=>{var x=i=>{try{p(c.next(i))}catch(u){m(u)}},s=i=>{try{p(c.throw(i))}catch(u){m(u)}},p=i=>i.done?r(i.value):Promise.resolve(i.value).then(x,s);p((c=c.apply(w,d)).next())});import{S as P}from"./index-6864474d.js";import{C as I}from"./index-e3e9b296.js";import{b as U,i as B,r as b,s as R,h as M}from"./index.js";import{a as S,b as V}from"./useLogin-c4244b2d.js";import{ai as h,$ as y,aj as E,_ as k}from"./antd-5cc557c7.js";import{d as N,k as _,r as T,_ as A,$ as D,a0 as $,a1 as g,u as e,f as a,aa as n,E as v}from"./vue-05cc5022.js";const j={class:"mb-3 text-2xl font-bold text-center xl:text-3xl enter-x xl:text-left"},W=N({__name:"RegForm",setup(w){const d=h.Item,c=y.Password,{t:r}=U(),m=_(),x=_(!1),s=T({account:"",password:"",confirmPassword:"",mobile:"",sms:"",policy:!1}),{getFormRules:p}=S(s),{validForm:i}=V(m),{notification:u,createErrorModal:H}=M();function C(){return f(this,null,function*(){const l=yield i();if(l){if(console.log(l),l.password!==l.confirmPassword){u.error({message:"错误",description:"两次密码不一致",duration:3});return}if(!l.sms||!l.mobile||!l.account||!l.policy){u.error({message:"错误",description:"必须输入社团名称、手机号和验证码，同意注册协议",duration:3});return}try{let o=yield B.post({url:"/reg_group",data:l},{errorMessageMode:"modal"});u.success({message:"成功",description:"注册成功，请登录",duration:3}),b.push({path:"/login"})}catch(o){}}})}function z(){return f(this,null,function*(){b.push({path:"/login"})})}function F(){return f(this,null,function*(){try{let l=yield R({mobile:s.mobile});console.log(l)}catch(l){return!1}return!0})}return(l,o)=>(A(),D("div",null,[$("h2",j,g(e(r)("sys.login.signUpFormTitle")),1),a(e(h),{class:"p-4 enter-x",model:s,rules:e(p),ref_key:"formRef",ref:m},{default:n(()=>[a(e(d),{name:"account",class:"enter-x"},{default:n(()=>[a(e(y),{class:"fix-auto-fill",size:"large",value:s.account,"onUpdate:value":o[0]||(o[0]=t=>s.account=t),placeholder:"社团名称"},null,8,["value"])]),_:1}),a(e(d),{name:"mobile",class:"enter-x"},{default:n(()=>[a(e(y),{size:"large",value:s.mobile,"onUpdate:value":o[1]||(o[1]=t=>s.mobile=t),placeholder:e(r)("sys.login.mobile"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),a(e(d),{name:"sms",class:"enter-x"},{default:n(()=>[a(e(I),{size:"large",class:"fix-auto-fill",value:s.sms,"onUpdate:value":o[2]||(o[2]=t=>s.sms=t),sendCodeApi:F,placeholder:e(r)("sys.login.smsCode")},null,8,["value","placeholder"])]),_:1}),a(e(d),{name:"password",class:"enter-x"},{default:n(()=>[a(e(P),{size:"large",value:s.password,"onUpdate:value":o[3]||(o[3]=t=>s.password=t),placeholder:e(r)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),a(e(d),{name:"confirmPassword",class:"enter-x"},{default:n(()=>[a(e(c),{size:"large",visibilityToggle:"",value:s.confirmPassword,"onUpdate:value":o[4]||(o[4]=t=>s.confirmPassword=t),placeholder:e(r)("sys.login.confirmPassword")},null,8,["value","placeholder"])]),_:1}),a(e(d),{class:"enter-x",name:"policy"},{default:n(()=>[a(e(E),{checked:s.policy,"onUpdate:checked":o[5]||(o[5]=t=>s.policy=t),size:"small"},{default:n(()=>[v(g(e(r)("sys.login.policy")),1)]),_:1},8,["checked"])]),_:1}),a(e(k),{type:"primary",class:"enter-x",size:"large",block:"",onClick:C,loading:x.value},{default:n(()=>[v(g(e(r)("sys.login.registerButton")),1)]),_:1},8,["loading"]),a(e(k),{size:"large",block:"",class:"mt-4 enter-x",onClick:z},{default:n(()=>[v(g(e(r)("sys.login.backSignIn")),1)]),_:1})]),_:1},8,["model","rules"])]))}});export{W as _};
